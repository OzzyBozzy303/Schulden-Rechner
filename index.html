<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Schulden-Tracker</title>
  <style>
    :root {
      --bg: #f9fafb;
      --card: #ffffff;
      --text: #1f2937;
      --muted: #6b7280;
      --primary: #2563eb;
      --primary-dark: #1e40af;
      --warn: #f59e0b;
      --success: #22c55e;
      --danger: #ef4444;
      --border: #e5e7eb;
    }
    * { box-sizing: border-box; }
    body {
      margin:0; font-family: "Inter", Arial, sans-serif;
      background: var(--bg); color: var(--text);
    }
    header {
      background: var(--primary); color:#fff;
      padding:1rem; text-align:center; font-size:1.3rem; font-weight:bold;
      box-shadow:0 2px 6px rgba(0,0,0,0.1);
    }
    .container { max-width:900px; margin:auto; padding:1rem; }
    .card {
      background: var(--card); border-radius:12px; padding:1rem; margin-bottom:1rem;
      border:1px solid var(--border); box-shadow:0 2px 6px rgba(0,0,0,0.05);
    }
    input, select, textarea, button {
      padding:0.8rem; border-radius:8px; border:1px solid var(--border);
      font-size:1rem; width:100%;
    }
    textarea { resize: vertical; }
    button {
      background: var(--primary); color:#fff; border:none; cursor:pointer; font-weight:600;
      transition: background 0.2s ease;
    }
    button:hover { background: var(--primary-dark); }
    .list .item {
      background: var(--bg); border-radius:10px; padding:0.8rem; margin-bottom:0.6rem;
      border:1px solid var(--border);
    }
    .status.offen { color: var(--warn); font-weight:bold; }
    .status.bezahlt { color: var(--success); font-weight:bold; }
    .person-card {
      background: var(--bg); border-radius:10px; padding:0.8rem; margin-bottom:0.6rem;
      border:1px solid var(--border);
    }
    .score-badge {
      padding:4px 10px; border-radius:999px; font-size:0.85rem; font-weight:bold;
    }
    .score-bad { background:rgba(239,68,68,0.15); color:var(--danger); }
    .score-avg { background:rgba(245,158,11,0.15); color:var(--warn); }
    .score-good { background:rgba(34,197,94,0.15); color:var(--success); }
  </style>
</head>
<body>
  <header>ðŸ“Š Schulden-Tracker</header>

  <div class="container">
    <div class="card">
      <h2>Neue Schuld erfassen</h2>
      <form id="debtForm">
        <input type="text" id="name" placeholder="Name" required />
        <input type="number" id="amount" placeholder="Betrag (â‚¬)" required />
        <input type="date" id="date" />
        <select id="status">
          <option value="offen">Offen</option>
          <option value="bezahlt">Bezahlt</option>
        </select>
        <textarea id="note" placeholder="Notiz"></textarea>
        <button type="submit">âž• HinzufÃ¼gen</button>
      </form>
    </div>

    <div class="card">
      <h2>Ãœbersicht</h2>
      <div id="list"></div>
    </div>

    <div class="card">
      <h2>PersonenÃ¼bersicht & KreditwÃ¼rdigkeit</h2>
      <div id="people"></div>
    </div>
  </div>

  <script>
    const STORAGE_KEY = "debts_v3";
    let debts = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];

    const form = document.getElementById("debtForm");
    const list = document.getElementById("list");
    const people = document.getElementById("people");

    form.addEventListener("submit", e => {
      e.preventDefault();
      const debt = {
        id: Date.now(),
        name: document.getElementById("name").value,
        amount: parseFloat(document.getElementById("amount").value),
        date: document.getElementById("date").value,
        status: document.getElementById("status").value,
        note: document.getElementById("note").value
      };
      debts.push(debt);
      localStorage.setItem(STORAGE_KEY, JSON.stringify(debts));
      form.reset();
      render();
    });

    function render() {
      list.innerHTML = "";
      debts.forEach(d => {
        const div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `
          <strong>${d.name}</strong> â€“ ${d.amount.toFixed(2)} â‚¬<br>
          <span class="status ${d.status}">${d.status}</span> | ${d.date || ""}<br>
          Notiz: ${d.note || ""}
        `;
        list.appendChild(div);
      });

      // PersonenÃ¼bersicht
      people.innerHTML = "";
      const grouped = {};
      debts.forEach(d => {
        if (!grouped[d.name]) grouped[d.name] = {offen:0, bezahlt:0, items:[]};
        grouped[d.name].items.push(d);
        if (d.status==="bezahlt") grouped[d.name].bezahlt += d.amount;
        else grouped[d.name].offen += d.amount;
      });
      Object.keys(grouped).forEach(name=>{
        const info = grouped[name];
        const score = calcScore(info);
        const div = document.createElement("div");
        div.className = "person-card";
        div.innerHTML = `
          <div style="display:flex;justify-content:space-between;align-items:center;">
            <strong>${name}</strong>
            <span class="score-badge ${score.cls}">Score: ${score.val}/100</span>
          </div>
          <div>Offen: ${info.offen.toFixed(2)} â‚¬ | Bezahlt: ${info.bezahlt.toFixed(2)} â‚¬</div>
          ${info.items.map(i=>`
            <div style="border-top:1px dashed var(--border);margin-top:6px;padding-top:6px;">
              ${i.amount.toFixed(2)} â‚¬ (${i.status}) â€“ ${i.note||""} ${i.date||""}
            </div>`).join("")}
        `;
        people.appendChild(div);
      });
    }

    function calcScore(info){
      let score=50;
      if(info.offen===0) score+=25;
      else if(info.offen<50) score+=15;
      else if(info.offen<200) score+=5;
      else score-=10;
      score+=Math.min(20, info.bezahlt/10);
      score=Math.max(0,Math.min(100,Math.round(score)));
      let cls="score-avg";
      if(score<40) cls="score-bad";
      if(score>=70) cls="score-good";
      return {val:score, cls};
    }

    render();
  </script>
</body>
</html>
